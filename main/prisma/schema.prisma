generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mongodb"
  url      = env("MONGODB_URI")
}

model User {
  id        String      @id @map("_id")
  name      String
  email     String      @unique
  password  String
  role      Role
  createdAt DateTime    @default(now())
  updatedAt DateTime    @updatedAt
  fundraiser Fundraiser?
  sponsorer  Sponsorer?
}

model Fundraiser {
  id          String      @id @map("_id")
  userId      String      @unique
  user        User        @relation(fields: [userId], references: [id])
  type        FundraiseType
  country     String
  state       String
  ageGroup    String
  pitch       String
  opportunities OpportunityTag[]
  fundraiserTags FundraiserTag[]
}

model Sponsorer {
  id          String      @id @map("_id")
  userId      Int         @unique
  user        User        @relation(fields: [userId], references: [id])
  type        FundraiseType
  country     String
  state       String
  ageGroup    String
  tags        Tag[]       @relation("SponsorerTags")
}

model Opportunity {
  id          String      @id @map("_id")
  fundraiser  Fundraiser  @relation(fields: [id], references: [id])
  opportunityTags OpportunityTag[]
  score           Float
  tags            OpportunityTag[]
}

model Tag {
  id          Int         @id @default(autoincrement())
  name        String      @unique
  fundraisers FundraiserTag[]
  sponsorers  Sponsorer[] @relation("SponsorerTags")
  opportunities Opportunity[] @relation("OpportunityTags")
  opportunityTags OpportunityTag[]
}

model FundraiserTag {
  id          String      @id @map("_id")
  fundraiser  Fundraiser  @relation(fields: [fundraiserId], references: [id])
  fundraiserId String
  tag         Tag         @relation(fields: [tagId], references: [id])
  tagId       Int
}

model OpportunityTag {
  id            String      @id @map("_id")
  opportunity   Opportunity @relation(fields: [opportunityId], references: [id])
  opportunityId Int
  tag           Tag         @relation(fields: [tagId], references: [id])
  tagId         Int
}

enum Role {
  FUNDRAISER
  SPONSORER
}

enum FundraiseType {
  SCHOLARSHIP
  EVENT
  RESEARCH_GROUP
}